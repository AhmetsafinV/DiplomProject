<p id="notice"><%= notice %></p>
<h1><%= @lesson_name.name %> </h1>
<h2><%= @lesson_name.human_htype  %> </h2>
<style type="text/css">

table {border-collapse:collapse; table-layout:fixed; width:80%;}
   table td { width:25%; word-wrap:break-word;}

    /*table {*/
   /*border-collapse: collapse;*/
   /*width: 80%;*/
  /*}*/
  /*table, th, td {*/
   /*border: 1px solid black;*/
  /*}*/
  /*.mark {*/
     /*width: 40%;*/
  /*}*/
</style>
<%= form_tag('/lessons/attendance', remote: true) do %>
<table class = "table table-striped table-bordered">
  <thead>
    <tr>
      <th width="20%">Студент</th>
      <% @lessons.order(:date).each do |lesson| %>
        <th>

          <div >
          <% if !(lesson.typeA==nil) %>
              <%= lesson.typeA %>
              </div>
          <%end %>
          <%if !(lesson.date == nil) %>
       <%= link_to lesson.date.strftime(' %d.%m'), edit_lesson_path(lesson) %>
          <%end %>
</th>

      <% end %>
    </tr>
  </thead>

  <tbody>
    <% @students.each do |student| %>
      <tr>
        <td width="15%" ><%= student.last_name %>
          <%= student.first_name %>
        <%= student.second_name %>
        </td>
          <% @lessons.order(:date).each do |lesson| %>
          <td>
            <% result = Result.find_by(lesson_id: lesson.id,student_id: student.id)%>
            <% if (result.attendance == true)%>
                  <%=  check_box("attendance", result.id, {checked: true}) %>
            <% else %>
                  <%= check_box("attendance", result.id) %>
            <% end %>
            <% if !(lesson.typeA == nil) %>
              <%= number_field("mark", result.id, in: 0..100, :class => "mark", :value => result.mark, class:"number field") %>
            <% end %>
          </td>
          <% end %>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<%= submit_tag "Сохранить", class:"btn btn-primary" %>
<br>


<%= javascript_include_tag "//www.google.com/jsapi", "chartkick" %>


 <%=pie_chart (@data_stat_mark), :library => { title: "Диаграмма успеваемости"}%>
  <%=column_chart (@data_stat_attedance), :library => { title: "Диаграмма посещаемости"}%>
